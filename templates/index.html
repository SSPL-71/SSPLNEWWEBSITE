<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SS Services - Claims Investigation, PDF Tools, Image Conversion</title>
  <meta name="description" content="SS Services in Karnataka provides expert claims investigations and free online PDF tools like 3ctool for image to PDF conversion, PDF compression, and file utilities. Now introducing ZzpDwn - the hassle-free Zip Extractor Tool to preview and access files directly without downloads.">
  <meta name="keywords" content="claims investigations Karnataka, PDF tools online free, 3ctool, image to PDF, PDF compression, SS Services, Sarvasiddhanta Services Private Limited, SSPL, image conversion, ZzpDwn, Zip Extractor Tool, unzip online, view zip files, extract zip images">
  <meta name="author" content="Sarvasiddhanta Services Private Limited">
  <link rel="icon" href="favicon.ico" type="image/x-icon">

  <!-- Analytics / Ads -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T4N9KCYHSF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-T4N9KCYHSF');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2931901961774543" crossorigin="anonymous"></script>

  <!-- Libraries used by the tools (kept intact) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.13.216/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
        .then(reg => console.log('Service Worker registered'))
        .catch(err => console.error('SW registration failed:', err));
    }
  </script>

  <!-- Consolidated and modernized styles (Option 4: blue/teal gradient theme) -->
  <style>
    :root{
      --bg-start: #d6f0ff;
      --bg-end: #c7f3ef;
      --card-bg: #ffffff;
      --muted: #6b7280;
      --accent: #0ea5a4; /* teal accent */
      --brand: #0b6b9a;
      --radius: 12px;
      --container-width: 1100px;
      --max-width-narrow: 900px;
      --glass: rgba(255,255,255,0.7);
    }
    html,body{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family: Inter, "Segoe UI", Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      background: linear-gradient(180deg,var(--bg-start),var(--bg-end));
      color:#1f2937;
      text-align:left;
    }
    a{color:var(--brand); text-decoration: none;}
    a:hover{text-decoration: underline;}

    /* Layout */
    .site {
      max-width: var(--container-width);
      margin: 24px auto;
      padding: 18px;
    }
    header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    .logo {
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo img{height:64px; border-radius:10px; box-shadow:0 6px 18px rgba(11,107,154,0.12);}
    .brand-title h1{font-size:1.1rem; margin:0; letter-spacing:0.6px;}
    .brand-title p{margin:0; color:var(--muted); font-size:0.95rem;}

    /* Door reveal hero */
    .door-container {
      position:relative;
      width:100%;
      min-height:36vh;
      border-radius:var(--radius);
      overflow:hidden;
      background: linear-gradient(135deg, rgba(255,255,255,0.35), rgba(255,255,255,0.15));
      box-shadow: 0 8px 30px rgba(11,107,154,0.08);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .door { position:absolute; width:50%; height:100%; display:flex; align-items:center; justify-content:center; color:white; font-weight:700; font-size:clamp(24px,4vw,56px); transition:transform 1.3s ease-in-out; background:#4a4a4a; }
    .left-door{left:0; transform-origin:left;}
    .right-door{right:0; transform-origin:right;}
    .door::before{opacity:0.95;}
    .brand {
      position:relative;
      z-index:2;
      text-align:center;
      opacity:0;
      transition:opacity 1.2s ease-in-out;
      color:var(--brand);
    }
    .brand img{height:88px; display:block; margin:0 auto 8px;}
    .brand h2{margin:6px 0 0; font-family: "Georgia", serif; font-weight:600; font-size:1rem; color:var(--brand);}

    /* Floating quick menu */
    .floating-menu {
      position:fixed;
      right:18px;
      top:160px;
      background: linear-gradient(135deg,#fff7fb,#ffffff);
      padding:12px;
      border-radius:12px;
      box-shadow: 0 10px 30px rgba(11,107,154,0.08);
      z-index:1000;
      width:220px;
      border-left:8px solid var(--accent);
      font-weight:600;
    }
    .floating-header{color:var(--accent); font-size:0.95rem; margin-bottom:8px;}
    .floating-menu a{display:block; padding:8px 6px; color:#0f1724; border-radius:8px; margin:6px 0; font-size:0.95rem;}
    .floating-menu a:hover{background:rgba(14,165,164,0.06); transform:translateX(4px);}

    .floating-toggle {
      display:none;
    }

    /* Content cards */
    .card { background: var(--card-bg); border-radius: 12px; padding: 22px; box-shadow: 0 6px 20px rgba(16,24,40,0.06); margin-bottom:20px; }
    .card h2{margin-top:0; color:#0f1724;}
    .two-col {display:flex; gap:18px; flex-wrap:wrap; align-items:center;}
    .two-col .left{flex:1 1 320px;}
    .two-col .right{flex:0 0 300px; text-align:center;}

    /* Buttons */
    .btn { display:inline-block; padding:10px 16px; border-radius:8px; background:var(--accent); color:white; font-weight:700; text-decoration:none; box-shadow: 0 6px 14px rgba(14,165,164,0.14); }
    .btn.secondary{background:#4f4f4f; box-shadow:none;}
    .btn.ghost{background:transparent; color:var(--brand); border:1px solid rgba(11,107,154,0.08);}

    /* Responsive */
    @media (max-width:900px){
      .floating-menu{display:none;}
      .site{padding:12px;}
      header{flex-direction:column; align-items:flex-start; gap:8px;}
      .brand img{height:64px;}
    }
    @media (max-width:600px){
      .door {font-size:34px;}
      .floating-toggle{display:block; position:fixed; bottom:18px; right:18px; z-index:1001; background:var(--accent); color:white; border-radius:50%; width:54px; height:54px; border:none; font-size:22px; box-shadow:0 8px 20px rgba(14,165,164,0.25);}
    }

    /* Utility */
    .center { text-align:center; }
    .muted { color:var(--muted); }
    .video-embed{border-radius:10px; overflow:hidden; box-shadow:0 6px 18px rgba(16,24,40,0.06);}
    .scroll-banner{background:#fff3f3; padding:10px; border-radius:8px; color:#b30000; font-weight:700; overflow:hidden;}
  </style>
</head>
<body>
  <div class="site">

    <!-- Header -->
    <header>
      <div class="logo">
        <img src="{{ url_for('static', filename='new_logo.jpg') }}" alt="SSPL logo">
        <div class="brand-title">
          <h1>SARVASIDDHANTA SERVICES PRIVATE LIMITED</h1>
          <p class="muted">Claims Investigation ¬∑ PDF Tools ¬∑ Image & ZIP utilities</p>
        </div>
      </div>

      <nav class="muted" aria-label="top links">
        <a href="#3CTool">3CTOOL</a> &nbsp; ‚Ä¢ &nbsp;
        <a href="#PMTOOL">PDF MERGER</a> &nbsp; ‚Ä¢ &nbsp;
        <a href="#ZIPTOOL">ZzpDwn</a>
      </nav>
    </header>

    <!-- Door reveal / hero -->
    <section class="door-container" aria-hidden="false">
      <div class="door left-door">SS</div>
      <div class="door right-door">PL</div>

      <div class="brand" id="heroBrand">
        <img src="{{ url_for('static', filename='new_logo.jpg') }}" alt="SSPL logo">
        <h2>Bestower of Skills & Wisdom ‚Äî SARVASIDDHANTA</h2>
      </div>
      <img src="{{ url_for('static', filename='Vaastu.png') }}" alt="Vaastu Symbol" style="height:48px; position:absolute; top:18px; right:28px;">
    </section>

    <!-- Floating quick access menu -->
    <button id="menuToggle" class="floating-toggle" aria-expanded="false">‚ò∞</button>
    <aside id="floatingMenu" class="floating-menu" role="navigation" aria-label="Quick access">
      <div class="floating-header">üìå Quick Access Menu</div>
      <a href="#GenTrac">üîê GenTrac Login</a>
      <a href="#3CTool">üõ†Ô∏è 3CTOOL</a>
      <a href="#PMTOOL">üìã PDF MERGER</a>
      <a href="#CMPRSTOOL">üì¶PDF COMPRESS</a>
      <a href="#SORTERTOOL">üîÄ PDF SORTER</a>
      <a href="#GPSTOOL">üì∏ GPS CAMERA PRO</a>
      <a href="#ZIPTOOL">üóÇ ZzpDwn - ZIP EXTRACT</a>
      <a href="#Donate">üéÅ DONATE</a>
      <a href="#BLOG">üìö BLOGS</a>
      <a href="#CONTACT">üì¨ CONTACT US</a>
    </aside>

    <!-- Quick-access toggle behavior (keeps original JS logic) -->
    <script>
      const toggleBtn = document.getElementById('menuToggle');
      const menu = document.getElementById('floatingMenu');
      if (toggleBtn) {
        toggleBtn.addEventListener('click', () => {
          menu.classList.toggle('show');
          const expanded = toggleBtn.getAttribute('aria-expanded') === 'true';
          toggleBtn.setAttribute('aria-expanded', String(!expanded));
        });
      }
      // Door animation
      document.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => {
          const left = document.querySelector(".left-door");
          const right = document.querySelector(".right-door");
          const brand = document.querySelector(".brand");
          if (left) left.style.transform = "rotateY(-90deg)";
          if (right) right.style.transform = "rotateY(90deg)";
          if (brand) brand.style.opacity = 1;
        }, 500);
      });
    </script>

    <!-- Intro card -->
    <section class="card">
      <div class="two-col">
        <div class="left">
          <div style="display:flex; gap:16px; align-items:center;">
            <img src="{{ url_for('static', filename='ganesha.png') }}" alt="Ganesha" style="height:96px; border-radius:8px;">
            <div>
              <h2 style="margin:0;">"SARVASIDDHANTA" MEANS BESTOWER OF SKILLS & WISDOM</h2>
              <p class="muted" style="margin-top:10px;">The quality of having experience, knowledge, good judgment; the quality of being wise. We bring 18+ years of claims investigation experience in Karnataka.</p>
            </div>
          </div>
        </div>
        <div class="right center">
          <a href="#3CTool" class="btn secondary" title="Explore tools">Explore Our Tools (Quick Menu ‚Üí)</a>
        </div>
      </div>
    </section>

    <!-- About / GenTrac -->
    <section class="card" id="GenTrac">
      <h2 class="center">We Designed & Built GenTrac</h2>
      <p class="muted center">GenTrac is a comprehensive app for claim investigation and verification. Streamline case updates, assign staff, track progress, and generate reports.</p>
      <div class="center" style="margin-top:12px;">
        <a class="btn" href="https://www.appsheet.com/Account/Login?FullScope=False&SpecificDomain=&provider=google&returnUrl=https%3A%2F%2Fwww.appsheet.com%2Fstart%2Fadb4f63a-262c-43b5-a8e0-58d53d726da8%3Fplatform%3Ddesktop&LimitedFullScope=&partner=&appName=SSPLGEN&externalFailure=&domainOnly=#vss=H4sIAAAAAAAAA62PywrCMBBFf6XMOl-QbXEhYjc-NsbF2Ewh2CalSa0l5N-d-EBwWVzmDOdwE-FmaNoFrK8gT_H72tAMEqKC_dyTAqmgdDYMrlUgFFTYveCh1xioqGgqSvTMEqSz-GQCeZBxUUX-ZYsAo8kG0xgacjIHOPXW-ZxlBj8qJAHdGPDS0vMXrKbErHH16EkfedjyQX5tV_cerd46zeUGW0_pAay9rOuIAQAA&view=Update%20New%20Case&appName=SSPLGEN-1724282" target="_blank" rel="noopener">Open GenTrac</a>
      </div>
    </section>

    <!-- Video area (GenTrac & GPS Camera Pro) -->
    <section class="card video-embed">
      <div style="display:flex; gap:24px; flex-wrap:wrap;">
        <div style="flex:1 1 320px;">
          <h3>üé• GenTrac Demo</h3>
          <div style="position:relative; padding-bottom:56.25%; height:0; overflow:hidden; border-radius:8px;">
            <iframe src="https://www.youtube.com/embed/sDhhMFpY1iQ" style="position:absolute; inset:0; width:100%; height:100%; border:0;" allowfullscreen></iframe>
          </div>
        </div>
        <div style="flex:1 1 320px;">
          <h3>üì∏ GPS Camera Pro</h3>
          <div style="position:relative; padding-bottom:56.25%; height:0; overflow:hidden; border-radius:8px;">
            <iframe src="https://www.youtube.com/embed/0ydFGCbIeY8" style="position:absolute; inset:0; width:100%; height:100%; border:0;" allowfullscreen></iframe>
          </div>
          <p class="center" style="margin-top:10px;"><a class="btn ghost" href="https://pdf-relay.onrender.com" target="_blank" rel="noopener">Open GPSTOOL</a></p>
        </div>
      </div>
    </section>

    <!-- Tools highlights (3CTool card) -->
    <section id="3CTool" class="card">
      <div style="display:flex; gap:18px; flex-wrap:wrap; align-items:center;">
        <img src="{{ url_for('static', filename='3CTool.png') }}" alt="3CTool" style="height:72px;">
        <div style="flex:1;">
          <h3>3CTool ‚Äî Crop ‚Ä¢ Compress ‚Ä¢ Convert</h3>
          <p class="muted">Crop, compress images/videos & convert images to PDF. Tools are hosted on free tiers; links open in a new tab.</p>
        </div>
        <div style="text-align:center;">
          <a class="btn" href="https://image-pdf-tool.onrender.com/" target="_blank" rel="noopener">Open 3C Tool</a>
        </div>
      </div>

      <div style="margin-top:14px;" class="scroll-banner">
        <strong>Note:</strong> Tools are offered free ‚Äî they may take a few seconds to load on free-tier hosts.
      </div>
    </section>

    <!-- PDF Tools: Merger, Compressor, Sorter condensed but intact - IDs preserved for tool scripts -->
    <section id="tools-collection">
      <!-- PDF Merger -->
      <div id="PMTOOL" class="card">
        <h3>PDF Merger Tool</h3>
        <p class="muted">Select multiple PDF files to merge into one document.</p>
        <input type="file" id="pdf-files" accept="application/pdf" multiple>
        <div style="margin-top:12px;"><button id="merge-btn" class="btn">Merge PDFs</button></div>
        <div id="merge-loader" style="display:none; margin-top:12px;">Processing... <span aria-hidden="true">‚è≥</span></div>
        <div id="merge-result" style="margin-top:14px;"></div>
      </div>

      <!-- PDF Compression -->
      <div id="CMPRSTOOL" class="card">
        <h3>PDF Compression Tool</h3>
        <p class="muted">Choose quality and compress PDF pages to images embedded in a new PDF (client-side).</p>
        <input type="file" id="pdf-file" accept="application/pdf">
        <div style="margin-top:8px;">Quality: <span id="quality-value">60%</span></div>
        <input type="range" id="quality-slider" min="10" max="90" value="60" style="width:100%; margin-top:6px;">
        <div style="margin-top:12px;"><button id="compress-btn" class="btn">Compress PDF</button></div>
        <div id="compress-loader" style="display:none; margin-top:12px;">Compressing... <span aria-hidden="true">‚è≥</span></div>
        <div id="compression-info" style="margin-top:12px;" class="muted"></div>
        <div id="compress-result" style="margin-top:12px;"></div>
      </div>

      <!-- Sorter Tool -->
      <div id="SORTERTOOL" class="card">
        <h3>PDF Page Sorter Tool</h3>
        <p class="muted">Upload a PDF, preview page thumbnails, drag to sort, rotate, then download a new ordered PDF.</p>
        <input type="file" id="pdf-sorter-file" accept="application/pdf">
        <div id="page-preview" style="display:flex; gap:12px; margin-top:12px; flex-wrap:wrap;"></div>
        <button id="download-sorted" style="display:none;" class="btn">Download Sorted PDF</button>
        <div id="sort-result" style="margin-top:12px;"></div>
      </div>
    </section>

    <!-- GPS Tool Card -->
    <section id="GPSTOOL" class="card center">
      <h3>GPS Camera Pro</h3>
      <p class="muted">Capture images with GPS tags ‚Äî convert or merge to PDF, download.</p>
      <a class="btn ghost" href="https://pdf-relay.onrender.com" target="_blank" rel="noopener">Open GPS Tool</a>
    </section>

    <!-- ZIP Extractor Tool Card (ZzpDwn) -->
    <section id="ZIPTOOL" class="card">
      <h3>ZzpDwn ‚Äî ZIP Extractor Tool</h3>
      <p class="muted">Preview images & PDFs inside a ZIP without downloading everything. Right-click any preview to save the file.</p>
      <div style="margin-top:10px;">
        <input type="file" id="zipFileInput" accept=".zip">
        <label style="margin-left:8px;"><input type="checkbox" id="selectAll"> Select All Images</label>
      </div>
      <div id="container" style="display:flex; gap:18px; margin-top:12px;">
        <ul id="fileList" style="flex:0 0 260px; list-style:none; padding:10px; background:#fff; border-radius:8px; max-height:400px; overflow:auto;"></ul>
        <div id="previewContainer" style="flex:1; display:flex; flex-wrap:wrap; gap:12px;"></div>
      </div>
    </section>

    <!-- Donate -->
    <section id="Donate" class="card center">
      <h3>Tools are free ‚Äî Wish to help?</h3>
      <p class="muted">Support development with a small donation.</p>
      <img src="https://img1.wsimg.com/isteam/ip/3313c4f3-2554-4adb-a588-9d9124283128/blob-8edbb2b.png/:/rs=h:300,m" alt="QR" style="width:180px; border-radius:8px; border:1px solid rgba(0,0,0,0.06);">
      <div style="margin-top:12px;">
        <form action="https://www.paypal.com/ncp/payment/G885MQJTUY6FN" method="post" target="_blank">
          <input type="submit" value="DONATE" style="padding:10px 18px; background:#ffd140; border:none; border-radius:8px; font-weight:700;">
        </form>
      </div>
      <p style="font-size:0.9rem; margin-top:10px;" class="muted">All donations are voluntary and support site maintenance.</p>
    </section>

    <!-- Blog links -->
    <section id="BLOG" class="card">
      <h3>Blogs</h3>
      <div style="max-height:240px; overflow:auto; padding-right:8px; font-size:0.95rem;">
        <ul style="padding-left:18px;">
          <li><a href="https://medium.com/@ksriyengar71/how-search-engines-get-it-wrong-detective-agencies-insurance-claim-investigators-70c29bdb7f05" target="_blank" rel="noopener">How Search Engines Get It Wrong: Detective Agencies ‚â† Insurance Claim Investigators</a></li>
          <li><a href="https://medium.com/@ksriyengar71/gps-camera-pro-capture-tag-convert-no-app-or-download-needed-the-gps-tool-for-ea07d0f9fba6" target="_blank" rel="noopener">GPS CAMERA PRO ‚Äî Capture, Tag, Convert</a></li>
          <li><a href="https://medium.com/@ksriyengar71/unlocking-productivity-with-sspls-free-online-tools-3c-tool-pdf-merger-pdf-compressor-and-d82964252ba2" target="_blank" rel="noopener">Unlocking Productivity with SSPL's Free Online Tools</a></li>
        </ul>
      </div>
    </section>

    <!-- Footer small -->
    <footer class="muted center" style="margin-top:18px; font-size:0.9rem;">
      <p>&copy; Sarvasiddhanta Services Private Limited ‚Äî All Rights Reserved</p>
    </footer>
  </div>

  <!-- Keep original tool scripts and inline logic unchanged (only moved some elements for structure) -->
  <!-- Merging/Compression/Sorter/Zip tool scripts preserved below as-is from original file to keep behavior identical. -->

  <!-- Merge tool script -->
  <script>
    // PDF Merger logic preserved (kept as in original file but consolidated placement)
    (function(){
      // Loader and merge logic (uses PDFLib already loaded above)
      const mergeBtn = document.getElementById('merge-btn');
      if (mergeBtn) {
        mergeBtn.addEventListener('click', async () => {
          const files = document.getElementById('pdf-files').files;
          if (!files || files.length < 2) return alert('Select at least two PDFs.');
          const loader = document.getElementById('merge-loader');
          const resultDiv = document.getElementById('merge-result');
          loader.style.display = 'block';
          try {
            const mergedPdf = await PDFLib.PDFDocument.create();
            for (const file of files) {
              const arrayBuffer = await file.arrayBuffer();
              const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
              const pages = await mergedPdf.copyPages(pdfDoc, pdfDoc.getPageIndices());
              pages.forEach(p => mergedPdf.addPage(p));
            }
            const bytes = await mergedPdf.save();
            const blob = new Blob([bytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `merged-${Date.now()}.pdf`;
            link.textContent = 'Click To Download Your Merged PDF / Long Press on Mobile';
            resultDiv.innerHTML = '';
            resultDiv.appendChild(link);
          } catch (err) {
            console.error('Merge failed', err);
            alert('Merge failed: ' + (err.message || err));
          } finally {
            loader.style.display = 'none';
            // celebrate
            try { confetti(); } catch(e){}
          }
        });
      }
    })();
  </script>

  <!-- Compression script (preserved) -->
  <script>
    (function(){
      const qualitySlider = document.getElementById('quality-slider');
      const qualityValue = document.getElementById('quality-value');
      const compressBtn = document.getElementById('compress-btn');
      const compressLoader = document.getElementById('compress-loader');
      if (qualitySlider) qualitySlider.addEventListener('input', ()=>{ if(qualityValue) qualityValue.textContent = qualitySlider.value + '%'; });
      if (compressBtn) {
        compressBtn.addEventListener('click', async () => {
          const fileInput = document.getElementById('pdf-file');
          const resultDiv = document.getElementById('compress-result');
          const info = document.getElementById('compression-info');
          if (!fileInput || fileInput.files.length === 0) { alert('Please select a PDF file.'); return; }
          const file = fileInput.files[0];
          compressLoader.style.display = 'block';
          try {
            const arrayBuffer = await file.arrayBuffer();
            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer, { ignoreEncryption: true });
            // Render pages to canvas using pdf.js then embed as JPG in new PDF
            const compressedPdf = await PDFLib.PDFDocument.create();
            const pdfData = new Uint8Array(arrayBuffer);
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.13.216/pdf.worker.min.js';
            const loadingTask = pdfjsLib.getDocument({ data: pdfData });
            const pdf = await loadingTask.promise;
            for (let i = 0; i < pdf.numPages; i++) {
              const page = await pdf.getPage(i+1);
              const viewport = page.getViewport({ scale: 1.0 });
              const canvas = document.createElement('canvas');
              const context = canvas.getContext('2d');
              canvas.width = viewport.width;
              canvas.height = viewport.height;
              await page.render({ canvasContext: context, viewport }).promise;
              const compressionLevel = qualitySlider ? qualitySlider.value/100 : 0.6;
              const compressedImg = canvas.toDataURL('image/jpeg', compressionLevel);
              const newPage = compressedPdf.addPage([viewport.width, viewport.height]);
              const jpgImage = await compressedPdf.embedJpg(compressedImg);
              newPage.drawImage(jpgImage, { x:0, y:0, width:viewport.width, height:viewport.height });
            }
            const compressedBytes = await compressedPdf.save();
            const blob = new Blob([compressedBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            const finalSize = blob.size;
            info.innerHTML = `Compressed Size: ${(finalSize/1024/1024).toFixed(2)} MB`;
            resultDiv.innerHTML = `<a href="${url}" download="compressed-${Date.now()}.pdf">Click To Download Your Compressed PDF</a>`;
          } catch (err) {
            console.error('Compression error', err);
            resultDiv.innerHTML = `<p style="color:red;">Error: ${err.message || err}</p>`;
          } finally {
            compressLoader.style.display = 'none';
            try { confetti(); } catch(e){}
          }
        });
      }
    })();
  </script>

  <!-- Sorter script (preserved) -->
  <script>
    (function(){
      const sorterInput = document.getElementById('pdf-sorter-file');
      const previewContainer = document.getElementById('page-preview');
      const downloadButton = document.getElementById('download-sorted');
      let loadedPdfDoc = null;
      let rotations = {};
      if (sorterInput) {
        sorterInput.addEventListener('change', async (e)=>{
          const file = e.target.files[0];
          if (!file) return;
          const arrayBuffer = await file.arrayBuffer();
          const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
          loadedPdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
          previewContainer.innerHTML = '';
          rotations = {};
          for (let i=0;i<pdf.numPages;i++){
            const page = await pdf.getPage(i+1);
            const viewport = page.getViewport({ scale: 0.3 });
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = viewport.width;
            canvas.height = viewport.height;
            await page.render({ canvasContext: context, viewport }).promise;
            const wrapper = document.createElement('div');
            wrapper.className = 'page-thumb';
            wrapper.setAttribute('data-index', i);
            wrapper.style.position = 'relative';
            wrapper.appendChild(canvas);
            const rotateBtn = document.createElement('div');
            rotateBtn.textContent = '‚ü≥';
            rotateBtn.title = 'Rotate';
            rotateBtn.style.position = 'absolute';
            rotateBtn.style.top = '5px';
            rotateBtn.style.right = '5px';
            rotateBtn.style.background = '#FFD700';
            rotateBtn.style.padding = '5px';
            rotateBtn.style.borderRadius = '5px';
            rotateBtn.style.cursor = 'pointer';
            rotateBtn.style.fontSize = '20px';
            rotateBtn.onclick = ()=>{ rotations[i] = (rotations[i]||0)+90; canvas.style.transform = `rotate(${rotations[i]}deg)`; };
            wrapper.appendChild(rotateBtn);
            previewContainer.appendChild(wrapper);
          }
          downloadButton.style.display = 'inline-block';
          Sortable.create(previewContainer, { animation: 150 });
        });
      }
      if (downloadButton) {
        downloadButton.addEventListener('click', async ()=>{
          const sortedIndices = Array.from(previewContainer.children).map(div=>parseInt(div.getAttribute('data-index')));
          const newPdf = await PDFLib.PDFDocument.create();
          const copiedPages = await newPdf.copyPages(loadedPdfDoc, sortedIndices);
          copiedPages.forEach((page,i)=>{
            const rotationAngle = rotations[sortedIndices[i]] || 0;
            page.setRotation(PDFLib.degrees(rotationAngle));
            newPdf.addPage(page);
          });
          const pdfBytes = await newPdf.save();
          const blob = new Blob([pdfBytes], { type: 'application/pdf' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = `sorted-${Date.now()}.pdf`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);
        });
      }
    })();
  </script>

  <!-- ZIP extractor script preserved -->
  <script src="https://cdn.jsdelivr.net/npm/jszip/dist/jszip.min.js"></script>
  <script>
    (function(){
      let archive;
      async function isBlobPDF(blob) {
        const buffer = await blob.slice(0,5).arrayBuffer();
        const header = new TextDecoder().decode(buffer);
        return header === '%PDF-';
      }
      function createPreview(filename, rawBlobOrArrayBuffer) {
        const previewContainer = document.getElementById('previewContainer');
        const toArrayBuffer = async (input) => { if (input instanceof ArrayBuffer) return input; return await input.arrayBuffer(); };
        toArrayBuffer(rawBlobOrArrayBuffer).then(async (ab) => {
          const probeBlob = new Blob([ab]);
          const isPDF = await isBlobPDF(probeBlob);
          let previewElement; let url;
          if (isPDF) {
            const pdfBlob = new Blob([ab], { type: 'application/pdf' });
            url = URL.createObjectURL(pdfBlob);
            const iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.type = 'application/pdf';
            iframe.style.width = '100%';
            iframe.style.height = '600px';
            previewElement = iframe;
          } else if (/\.(png|jpg|jpeg|gif|webp)$/i.test(filename)) {
            const mimeType = filename.toLowerCase().endsWith('.png') ? 'image/png' : 'image/jpeg';
            const imgBlob = new Blob([ab], { type: mimeType });
            url = URL.createObjectURL(imgBlob);
            const img = document.createElement('img');
            img.src = url; img.dataset.filename = filename; img.style.maxWidth='100%'; img.style.height='auto';
            previewElement = img;
          } else {
            previewElement = document.createElement('div');
            previewElement.textContent = `[File] ${filename}`;
          }
          previewElement.dataset.filename = filename;
          if (url) previewElement.dataset.url = url;
          previewContainer.appendChild(previewElement);
        }).catch(err => console.error('Preview error:', err));
      }
      document.getElementById('zipFileInput').addEventListener('change', async function (event) {
        const file = event.target.files[0]; if (!file) return;
        const name = file.name.toLowerCase();
        const arrayBuffer = await file.arrayBuffer();
        const fileList = document.getElementById('fileList'); const previewContainer = document.getElementById('previewContainer');
        fileList.innerHTML = ''; previewContainer.innerHTML='';
        let entries=[]; let getFileData;
        const allowedExts = ['.pdf','.png','.jpg','.jpeg','.gif','.webp'];
        try {
          if (name.endsWith('.zip')) {
            archive = await JSZip.loadAsync(file);
            entries = Object.keys(archive.files).filter(fn => !archive.files[fn].dir).filter(fn => allowedExts.some(ext => fn.toLowerCase().endsWith(ext)));
            getFileData = async (filename) => archive.files[filename].async('arraybuffer');
          } else { alert('Unsupported archive type'); return; }
        } catch (err) { console.error('Error extracting archive:', err); return; }
        entries.forEach(filename => {
          const listItem = document.createElement('li');
          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox'; checkbox.dataset.filename = filename;
          listItem.appendChild(checkbox); listItem.appendChild(document.createTextNode(' ' + filename));
          fileList.appendChild(listItem);
          checkbox.addEventListener('change', async function () {
            const existing = previewContainer.querySelector(`[data-filename='${filename}']`);
            if (!this.checked && existing) { if (existing.dataset.url) URL.revokeObjectURL(existing.dataset.url); existing.remove(); return; }
            if (this.checked) {
              try { const ab = await getFileData(filename); if (ab) createPreview(filename, ab); } catch (err){ console.error(`Error loading ${filename}:`, err); }
            }
          });
        });
      });
      document.getElementById('selectAll').addEventListener('change', function () {
        const checkboxes = document.querySelectorAll('#fileList input[type="checkbox"]');
        checkboxes.forEach(cb => { cb.checked = this.checked; cb.dispatchEvent(new Event('change', { bubbles: true })); });
      });
    })();
  </script>

  <!-- small ad script preserved -->
  <script type="text/javascript">
    atOptions = { 'key':'d76052090799493fc61caae4a413bb90','format':'iframe','height':60,'width':468,'params':{} };
  </script>
  <script type="text/javascript" src="//www.highperformanceformat.com/d76052090799493fc61caae4a413bb90/invoke.js"></script>

</body>
</html>
